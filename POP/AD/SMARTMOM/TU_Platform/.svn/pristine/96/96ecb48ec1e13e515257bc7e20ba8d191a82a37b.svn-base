<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--200327/pyr/B2BI입고정보검증 신규페이지 추가-->
<!--200331/chs/처리유무 조회조건 추가(APPLY_FLAG)-->
<mapper namespace="com.thirautech.mom.shipping.b2biReceivingVerification">

    <select id="get_b2biReceivingVerification_list" resultType="camelMap" parameterType="java.util.HashMap">
    	SELECT PO_NUMBER
    		 , DEPARTURE_NUMBER
    		 , TRANSACTION_TYPE
    		 , PART_NO
    		 , RECEIVING_QUANTITY
    		 , TO_CHAR(DEPARTURE_DATE,'YYYY-MM-DD HH24:MI:SS') AS DEPARTURE_DATE
    		 , TO_CHAR(RECEIVING_DATE,'YYYY-MM-DD HH24:MI:SS') AS RECEIVING_DATE
    		 , DESCRIPTION
    		 , APPLY_FLAG
    		 , SEND_SEQ
    	FROM MOM_LGE_B2B_RECEIVING
    	WHERE DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
    	  AND DEPARTURE_DATE BETWEEN TO_DATE(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD') AND TO_DATE(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD') + 23.9997/24
    	  <if test="description != '' and description != null">
    	  AND DESCRIPTION = #{description, jdbcType=VARCHAR}
    	  </if>
    	  <if test = "applyFlag != null and applyFlag != ''">
		  AND    APPLY_FLAG = #{applyFlag, jdbcType=VARCHAR}
 		  </if>
 		  <if test="poNumber != null and poNumber !=''">
 		  AND PO_NUMBER LIKE '%' || TRIM(#{poNumber, jdbcType=VARCHAR}) || '%'
 		  </if>
 		  <if test="departureNumber != null and departureNumber !=''">
 		  AND DEPARTURE_NUMBER LIKE '%' || TRIM(UPPER(#{departureNumber, jdbcType=VARCHAR})) || '%'
 		  </if>
    	  ORDER BY PO_NUMBER, DEPARTURE_NUMBER, SEND_SEQ
    </select>
     
</mapper>