<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.thirautech.mom.widget">
	<resultMap 	type="HashMap" 				id="widgetSettingMap">
		<result property="pageId" 			column="PAGE_ID" 			javaType="java.lang.String" jdbcType="VARCHAR" 	/>
		<result property="pageName" 		column="PAGE_NAME" 			javaType="java.lang.String" jdbcType="VARCHAR" 	/>
		<result property="gridProperty" 	column="GRID_PROPERTY" 		javaType="java.lang.String" jdbcType="VARCHAR" 	/>
		<result property="columnProperty" 	column="COLUMN_PROPERTY" 	javaType="java.lang.String" jdbcType="CLOB" 	/>
		<result property="searchFilter"		column="SEARCH_FILTER" 		javaType="java.lang.String" jdbcType="VARCHAR" 	/>
		<result property="processTran" 		column="PROCESS_TRAN" 		javaType="java.lang.String" jdbcType="VARCHAR" 	/>
	</resultMap>
	
	<resultMap 	type="HashMap" 				id="htmlSettingMap">
		<result property="pageId" 			column="PAGE_ID" 			javaType="java.lang.String" jdbcType="VARCHAR" 	/>
		<result property="pageName" 		column="PAGE_NAME" 			javaType="java.lang.String" jdbcType="VARCHAR" 	/>
		<result property="columnProperty" 	column="COLUMN_PROPERTY" 	javaType="java.lang.String" jdbcType="CLOB" 	/>
	</resultMap>
	
	
	<!-- 잠시 -->
	<resultMap 	type="HashMap" 				id="micaSettingMap">
		<result property="id" 				column="ID" 				javaType="java.lang.String" jdbcType="VARCHAR" 	/>
		<result property="name" 			column="NAME" 				javaType="java.lang.String" jdbcType="VARCHAR" 	/>
		<result property="datasetId" 		column="DATASET_ID" 		javaType="java.lang.String" jdbcType="VARCHAR" 	/>
		<result property="widgetType" 		column="WIDGET_TYPE" 		javaType="java.lang.String" jdbcType="VARCHAR" 	/>
		<result property="description" 		column="DESCRIPTION" 		javaType="java.lang.String" jdbcType="VARCHAR" 	/>
		<result property="setting" 			column="SETTING" 			javaType="java.lang.String" jdbcType="CLOB" 	/>
	</resultMap>
	
	<select id="get_widgetprop1_list" resultMap="micaSettingMap">
		SELECT 
			  ID
			, NAME
			, DATASET_ID
			, WIDGET_TYPE
			, DESCRIPTION
			, SETTING
		FROM 
			MICA_WIDGET 
		WHERE 
			DIVISION_CD 	= #{divisionCd, jdbcType=VARCHAR}         
	   		AND COMPANY_CD 	= #{companyCd, jdbcType=VARCHAR} 
	   		<if test = "id != null and id != ''">
	   		AND ID 			= #{id, jdbcType=VARCHAR}
	   		</if>
	</select>
	<!-- 잠시 -->
	
	<insert id="create_widgetprop1" parameterType="java.util.HashMap">
		INSERT INTO MICA_WIDGET(
			  ID
			, NAME
			, DATASET_ID
			, WIDGET_TYPE
			, DESCRIPTION
			, SETTING
			, DIVISION_CD
			, COMPANY_CD
		)
		VALUES(
			  #{id, jdbcType=VARCHAR}
			, #{name, jdbcType=VARCHAR}
			, #{datasetId, jdbcType=VARCHAR}
			, #{widgetType, jdbcType=VARCHAR}
			, #{description, jdbcType=VARCHAR}
			, #{setting, jdbcType=CLOB}
			, #{divisionCd, jdbcType=VARCHAR}
        	, #{companyCd, jdbcType=VARCHAR}
		)
	</insert>
	
	<update id="modify_widgetprop1" parameterType="java.util.HashMap">
		UPDATE 
			MICA_WIDGET
		SET 
			  NAME = #{name, jdbcType=VARCHAR}
			, DATASET_ID = #{datasetId, jdbcType=VARCHAR}
			, WIDGET_TYPE = #{widgetType, jdbcType=VARCHAR}
			, DESCRIPTION = #{description, jdbcType=VARCHAR}
			, SETTING = #{setting, jdbcType=CLOB}
		WHERE
			    DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
			AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR}
			AND ID = #{id, jdbcType=VARCHAR}
	</update>
	
	<select id="get_page_list" resultType="camelMap" parameterType="java.util.HashMap">
		SELECT 
			PAGE_ID AS CODE, 
			PAGE_NAME AS NAME
		FROM 
			MOM_WIDGET
		WHERE 
			DIVISION_CD 	= #{divisionCd, jdbcType=VARCHAR}         
	   		AND COMPANY_CD 	= #{companyCd, jdbcType=VARCHAR} 
	   	ORDER BY PAGE_NAME ASC
	</select>
	
	<select id="get_widgetprop_list" resultMap="widgetSettingMap">
		SELECT 
			  PAGE_ID
			, PAGE_NAME
			, GRID_PROPERTY 
			, COLUMN_PROPERTY
			, SEARCH_FILTER
			, PROCESS_TRAN
			, INDEX_COLUMN
		FROM 
			MOM_WIDGET 
		WHERE
			DIVISION_CD 	= #{divisionCd, jdbcType=VARCHAR}         
	   		AND COMPANY_CD 	= #{companyCd, jdbcType=VARCHAR}  
			AND PAGE_ID 	= #{pageId, jdbcType=VARCHAR}
			<!-- AND FLAG		= #{flag, jdbcType=INTEGER} -->
	</select>
	
	<insert id="create_widgetprop" parameterType="java.util.HashMap">
        INSERT INTO MOM_WIDGET(
        	  DIVISION_CD
        	, COMPANY_CD
        	, PAGE_ID
        	, PAGE_NAME
        	, GRID_PROPERTY
        	, SEARCH_FILTER
        	, PROCESS_TRAN 
        	, INDEX_COLUMN
        	, COLUMN_PROPERTY
        )
        VALUES (
        	  #{divisionCd, jdbcType=VARCHAR}
        	, #{companyCd, jdbcType=VARCHAR}
        	, #{pageId, jdbcType=VARCHAR} 
        	, #{pageName, jdbcType=VARCHAR}
        	, #{gridProperty, jdbcType=VARCHAR}
        	, #{searchFilter, jdbcType=VARCHAR}
        	, #{processTran, jdbcType=VARCHAR}
        	, #{indexColumn, jdbcType=VARCHAR}
        	, #{columnProperty,jdbcType=CLOB}
        )
    </insert>
    
    <update id="modify_widgetprop" parameterType="java.util.HashMap">
    	UPDATE MOM_WIDGET
    	SET
    		  PAGE_NAME 		= #{pageName, jdbcType=VARCHAR}
    		, GRID_PROPERTY 	= #{gridProperty, jdbcType=VARCHAR}
    		, SEARCH_FILTER 	= #{searchFilter, jdbcType=VARCHAR}
    		, PROCESS_TRAN 		= #{processTran, jdbcType=VARCHAR}
    		, INDEX_COLUMN 		= #{indexColumn, jdbcType=VARCHAR}
    		, COLUMN_PROPERTY 	= #{columnProperty,jdbcType=CLOB}
    	WHERE 
    		DIVISION_CD 	= #{divisionCd, jdbcType=VARCHAR}
    		AND COMPANY_CD 	= #{companyCd, jdbcType=VARCHAR}
    		AND PAGE_ID 	= #{pageId, jdbcType=VARCHAR}
    </update>
    
    
    
    
    
    <select id="get_html_list" resultType="camelMap" parameterType="java.util.HashMap">
		SELECT 
			PAGE_ID AS CODE, 
			PAGE_NAME AS NAME
		FROM 
			MOM_HTML
		WHERE 
			DIVISION_CD 	= #{divisionCd, jdbcType=VARCHAR}         
	   		AND COMPANY_CD 	= #{companyCd, jdbcType=VARCHAR} 
	</select>
	
	<select id="get_htmlprop_list" resultMap="htmlSettingMap">
		SELECT 
			PAGE_ID,
			PAGE_NAME,
			COLUMN_PROPERTY
		FROM 
			MOM_HTML 
		WHERE
			DIVISION_CD 	= #{divisionCd, jdbcType=VARCHAR}         
	   		AND COMPANY_CD 	= #{companyCd, jdbcType=VARCHAR}  
			AND PAGE_ID 	= NVL(#{pageId, jdbcType=VARCHAR}, 'MOMIA003_1') 
	</select>
	
	<insert id="create_htmlprop" parameterType="java.util.HashMap">
        INSERT INTO MOM_HTML(
        	DIVISION_CD, 
        	COMPANY_CD, 
        	PAGE_ID, 
        	PAGE_NAME, 
        	COLUMN_PROPERTY
        )
        VALUES (
        	#{divisionCd, jdbcType=VARCHAR}, 
        	#{companyCd, jdbcType=VARCHAR}, 
        	#{pageId, jdbcType=VARCHAR}, 
        	#{pageName, jdbcType=VARCHAR}, 
        	#{columnProperty,jdbcType=CLOB}
        )
    </insert>
    
    <update id="modify_htmlprop" parameterType="java.util.HashMap">
    	UPDATE MOM_HTML
    	SET
    		PAGE_NAME 		= #{pageName, jdbcType=VARCHAR},
    		COLUMN_PROPERTY = #{columnProperty,jdbcType=CLOB}
    	WHERE 
    		DIVISION_CD 	= #{divisionCd, jdbcType=VARCHAR}
    		AND COMPANY_CD 	= #{companyCd, jdbcType=VARCHAR}
    		AND PAGE_ID 	= #{pageId, jdbcType=VARCHAR}
    </update>
    
    <!-- <delete id="remove_htmlprop" parameterType="java.util.HashMap">
		DELETE FROM MOM_HTML
		WHERE 
			DIVISION_CD 	= #{divisionCd, jdbcType=VARCHAR}
    		AND COMPANY_CD 	= #{companyCd, jdbcType=VARCHAR}
    		AND PAGE_ID 	= #{pageId, jdbcType=VARCHAR}
	</delete> -->
</mapper>