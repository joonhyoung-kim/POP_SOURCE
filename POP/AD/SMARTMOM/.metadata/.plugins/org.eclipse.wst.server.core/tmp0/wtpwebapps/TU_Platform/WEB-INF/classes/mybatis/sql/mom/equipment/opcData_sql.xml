<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.thirautech.mom.equipment.opcData">
	<select id="get_opcData1_list" resultType="camelMap" parameterType="java.util.HashMap">
		SELECT MAX(S1_L_WORKMODEL) AS S1_L_WORKMODEL
		     , MAX(S1_U_STATUS) AS S1_U_STATUS
		     , MAX(S1_U_WORKMODEL) AS S1_U_WORKMODEL
		     , MAX(S1_U_CT) AS S1_U_CT
		     , MAX(S1_U_QTY) AS S1_U_QTY
		     , MAX(S1_R1_QTY) AS S1_R1_QTY
		     , MAX(S1_R2_QTY) AS S1_R2_QTY
		     , MAX(S1_R3_QTY) AS S1_R3_QTY
		     , MAX(S1_R4_QTY) AS S1_R4_QTY
		     , MAX(S1_R5_QTY) AS S1_R5_QTY
		     , MAX(S2_L_AUTORUN) AS S2_L_AUTORUN
		     , MAX(S2_U_UP_COUNT) AS S2_U_UP_COUNT
		     , MAX(S3_L_WORKMODEL) AS S3_L_WORKMODEL
		     , MAX(S3_U_CT) AS S3_U_CT
		     , MAX(S3_U_AUTORUN) AS S3_U_AUTORUN
		     , MAX(S3_U_QTY) AS S3_U_QTY
		     , MAX(S3_U_CONV_UP) AS S3_U_CONV_UP
		     , MAX(S3_U_CONV_DN) AS S3_U_CONV_DN
		     , MAX(S3_S1_SENSOR) AS S3_S1_SENSOR
		     , MAX(S3_S2_SENSOR) AS S3_S2_SENSOR
		     , MAX(S3_S3_SENSOR) AS S3_S3_SENSOR
		     , MAX(S3_S4_SENSOR) AS S3_S4_SENSOR
		     , MAX(S3_S5_SENSOR) AS S3_S5_SENSOR
		     , MAX(S3_S6_SENSOR) AS S3_S6_SENSOR
		     , MAX(S3_S7_SENSOR) AS S3_S7_SENSOR
		     , MAX(S3_CONV_UP_CONV) AS S3_CONV_UP_CONV
		     , MAX(S3_CONV_DN_CONV) AS S3_CONV_DN_CONV
		     , MAX(S4_L_AUTORUN) AS S4_L_AUTORUN
		     , MAX(S4_U_DN_COUNT) AS S4_U_DN_COUNT
		  FROM (SELECT SCENARIO_TYPE
		             , S1_L_WORKMODEL
		             , S1_U_STATUS
		             , S1_U_WORKMODEL
		             , S1_U_CT
		             , S1_U_QTY
		             , S1_R1_QTY
		             , S1_R2_QTY
		             , S1_R3_QTY
		             , S1_R4_QTY
		             , S1_R5_QTY
		             , '' S2_L_AUTORUN
		             , '' S2_U_UP_COUNT
		             , '' S3_L_WORKMODEL
		             , '' S3_U_CT
		             , '' S3_U_AUTORUN
		             , '' S3_U_QTY
		             , '' S3_U_CONV_UP
		             , '' S3_U_CONV_DN
		             , '' S3_S1_SENSOR
		             , '' S3_S2_SENSOR
		             , '' S3_S3_SENSOR
		             , '' S3_S4_SENSOR
		             , '' S3_S5_SENSOR
		             , '' S3_S6_SENSOR
		             , '' S3_S7_SENSOR
		             , '' S3_CONV_UP_CONV
		             , '' S3_CONV_DN_CONV
		             , '' S4_L_AUTORUN
		             , '' S4_U_DN_COUNT
		          FROM TU_OPC_S1
		         WHERE DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
		           AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR}
        UNION ALL
		SELECT SCENARIO_TYPE
             , '' S1_L_WORKMODEL
             , '' S1_U_STATUS
             , '' S1_U_WORKMODEL
             , '' S1_U_CT
             , '' S1_U_QTY
             , '' S1_R1_QTY
             , '' S1_R2_QTY
             , '' S1_R3_QTY
             , '' S1_R4_QTY
             , '' S1_R5_QTY
             , S2_L_AUTORUN
             , S2_U_UP_COUNT
             , '' S3_L_WORKMODEL
             , '' S3_U_CT
             , '' S3_U_AUTORUN
             , '' S3_U_QTY
             , '' S3_U_CONV_UP
             , '' S3_U_CONV_DN
             , '' S3_S1_SENSOR
             , '' S3_S2_SENSOR
             , '' S3_S3_SENSOR
             , '' S3_S4_SENSOR
             , '' S3_S5_SENSOR
             , '' S3_S6_SENSOR
             , '' S3_S7_SENSOR
             , '' S3_CONV_UP_CONV
             , '' S3_CONV_DN_CONV
             , '' S4_L_AUTORUN
             , '' S4_U_DN_COUNT
          FROM TU_OPC_S2
         WHERE DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
           AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR}
		         UNION ALL
		SELECT SCENARIO_TYPE
             , '' S1_L_WORKMODEL
             , '' S1_U_STATUS
             , '' S1_U_WORKMODEL
             , '' S1_U_CT
             , '' S1_U_QTY
             , '' S1_R1_QTY
             , '' S1_R2_QTY
             , '' S1_R3_QTY
             , '' S1_R4_QTY
             , '' S1_R5_QTY
             , '' S2_L_AUTORUN
             , '' S2_U_UP_COUNT
             , S3_L_WORKMODEL
             , S3_U_CT
             , S3_U_AUTORUN
             , S3_U_QTY
             , S3_U_CONV_UP
             , S3_U_CONV_DN
             , S3_S1_SENSOR
             , S3_S2_SENSOR
             , S3_S3_SENSOR
             , S3_S4_SENSOR
             , S3_S5_SENSOR
             , S3_S6_SENSOR
             , S3_S7_SENSOR
             , S3_CONV_UP_CONV
             , S3_CONV_DN_CONV
             , '' S4_L_AUTORUN
             , '' S4_U_DN_COUNT
          FROM TU_OPC_S3
         WHERE DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
           AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR}
		UNION ALL
		SELECT SCENARIO_TYPE
             , '' S1_L_WORKMODEL
             , '' S1_U_STATUS
             , '' S1_U_WORKMODEL
             , '' S1_U_CT
             , '' S1_U_QTY
             , '' S1_R1_QTY
             , '' S1_R2_QTY
             , '' S1_R3_QTY
             , '' S1_R4_QTY
             , '' S1_R5_QTY
             , '' S2_L_AUTORUN
             , '' S2_U_UP_COUNT
             , '' S3_L_WORKMODEL
             , '' S3_U_CT
             , '' S3_U_AUTORUN
             , '' S3_U_QTY
             , '' S3_U_CONV_UP
             , '' S3_U_CONV_DN
             , '' S3_S1_SENSOR
             , '' S3_S2_SENSOR
             , '' S3_S3_SENSOR
             , '' S3_S4_SENSOR
             , '' S3_S5_SENSOR
             , '' S3_S6_SENSOR
             , '' S3_S7_SENSOR
             , '' S3_CONV_UP_CONV
             , '' S3_CONV_DN_CONV
             , S4_L_AUTORUN
             , S4_U_DN_COUNT
          FROM TU_OPC_S4
         WHERE DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
           AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR} ) 
	</select>
	<select id="get_opcData2_list" resultType="camelMap" parameterType="java.util.HashMap">
		SELECT S5_BARCODE
		     , TO_CHAR(S5_START_TM, 'yy-mm-dd hh24:mi:ss') AS S5_START_TM
		     , TO_CHAR(S5_END_TM, 'yy-mm-dd hh24:mi:ss') AS S5_END_TM
		     , S5_ENTIRE_JUDGE
		     , S5_TOP_JUDGE
		     , S5_BOTTOM_JUDGE
		     , S5_LEFT_JUDGE
		     , S5_RIGHT_JUDGE
		  FROM TU_OPC_S5
		 WHERE DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
           AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR}
	</select>
	
	<select id="get_opcDataExport1_list" resultType="camelMap" parameterType="java.util.HashMap">
	SELECT LAST_EVENT_SEQ
	     , DIVISION_CD
	     , COMPANY_CD
	     , RESOURCE_CD
	     , SCENARIO_TYPE
	     , S1_L_WORKMODEL
	     , S1_U_STATUS
	     , S1_U_WORKMODEL
	     , S1_U_CT
	     , S1_U_QTY
	     , S1_R1_QTY
	     , S1_R2_QTY
	     , S1_R3_QTY
	     , S1_R4_QTY
	     , S1_R5_QTY
	     , TO_CHAR(CREATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS CREATE_DATE
	     , CREATE_BY
	     , TO_CHAR(UPDATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS UPDATE_DATE
	     , UPDATE_BY
	  FROM TU_OPC_S1_HIST
	 WHERE (UPDATE_DATE >= TO_DATE(#{fromDate, jdbcType=VARCHAR}, 'yyyy-mm-dd')
	           AND UPDATE_DATE <![CDATA[<=]]> TO_DATE(#{toDate, jdbcType=VARCHAR}, 'yyyy-mm-dd') + 23.9997/24)
	   AND DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
	   AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR} 
	 ORDER BY LAST_EVENT_SEQ 
	</select>
	
	<select id="get_opcDataExport2_list" resultType="camelMap" parameterType="java.util.HashMap">
	SELECT LAST_EVENT_SEQ
	     , DIVISION_CD
	     , COMPANY_CD
	     , RESOURCE_CD 
	     , SCENARIO_TYPE 
	     , S2_L_AUTORUN 
	     , S2_U_UP_COUNT 
	     , TO_CHAR(CREATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS CREATE_DATE
	     , CREATE_BY
	     , TO_CHAR(UPDATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS UPDATE_DATE
	     , UPDATE_BY
	  FROM TU_OPC_S2_HIST
	 WHERE (UPDATE_DATE >= TO_DATE(#{fromDate, jdbcType=VARCHAR}, 'yyyy-mm-dd')
	           AND UPDATE_DATE <![CDATA[<=]]> TO_DATE(#{toDate, jdbcType=VARCHAR}, 'yyyy-mm-dd') + 23.9997/24)
	   AND DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
	   AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR}
	 ORDER BY LAST_EVENT_SEQ 
	</select>
	
	<select id="get_opcDataExport3_list" resultType="camelMap" parameterType="java.util.HashMap">
	SELECT LAST_EVENT_SEQ
	     , DIVISION_CD
	     , COMPANY_CD
	     , RESOURCE_CD
	     , SCENARIO_TYPE
	     , S3_L_WORKMODEL
	     , S3_U_CT
	     , S3_U_AUTORUN
	     , S3_U_QTY
	     , S3_U_CONV_UP
	     , S3_U_CONV_DN
	     , S3_S1_SENSOR
	     , S3_S2_SENSOR
	     , S3_S3_SENSOR
	     , S3_S4_SENSOR
	     , S3_S5_SENSOR
	     , S3_S6_SENSOR
	     , S3_S7_SENSOR
	     , S3_CONV_UP_CONV
	     , S3_CONV_DN_CONV
	     , TO_CHAR(CREATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS CREATE_DATE
	     , CREATE_BY
	     , TO_CHAR(UPDATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS UPDATE_DATE
	     , UPDATE_BY
	  FROM TU_OPC_S3_HIST
	 WHERE (UPDATE_DATE >= TO_DATE(#{fromDate, jdbcType=VARCHAR}, 'yyyy-mm-dd')
	           AND UPDATE_DATE <![CDATA[<=]]> TO_DATE(#{toDate, jdbcType=VARCHAR}, 'yyyy-mm-dd') + 23.9997/24)
	   AND DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
	   AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR}
	 ORDER BY LAST_EVENT_SEQ 
	</select>
	
	<select id="get_opcDataExport4_list" resultType="camelMap" parameterType="java.util.HashMap">
	SELECT LAST_EVENT_SEQ
	     , DIVISION_CD
	     , COMPANY_CD
	     , RESOURCE_CD
	     , SCENARIO_TYPE
	     , S4_L_AUTORUN
	     , S4_U_DN_COUNT
	     , TO_CHAR(CREATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS CREATE_DATE
	     , CREATE_BY
	     , TO_CHAR(UPDATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS UPDATE_DATE
	     , UPDATE_BY
	  FROM TU_OPC_S4_HIST
	 WHERE (UPDATE_DATE >= TO_DATE(#{fromDate, jdbcType=VARCHAR}, 'yyyy-mm-dd')
	           AND UPDATE_DATE <![CDATA[<=]]> TO_DATE(#{toDate, jdbcType=VARCHAR}, 'yyyy-mm-dd') + 23.9997/24)
	   AND DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
	   AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR}
	 ORDER BY LAST_EVENT_SEQ 
	</select>
	
	<select id="get_opcDataExport5_list" resultType="camelMap" parameterType="java.util.HashMap">
	SELECT LAST_EVENT_SEQ
	     , DIVISION_CD
	     , COMPANY_CD
	     , RESOURCE_CD
	     , S5_MODEL
	     , S5_BARCODE
	     , S5_ENTIRE_JUDGE
	     , TO_CHAR(S5_START_TM, 'YYYY-MM-DD HH24:MI:SS') AS S5_START_TM
	     , TO_CHAR(S5_END_TM, 'YYYY-MM-DD HH24:MI:SS') AS S5_END_TM
	     , S5_TOP
	     , S5_TOP_JUDGE
	     , S5_BOTTOM
	     , S5_BOTTOM_JUDGE
	     , S5_LEFT
	     , S5_LEFT_JUDGE
	     , S5_RIGHT
	     , S5_RIGHT_JUDGE
	     , S5_TOP1
	     , S5_TOP2
	     , S5_TOP3
	     , S5_TOP4
	     , S5_TOP5
	     , S5_TOP6
	     , S5_TOP7
	     , S5_TOP8
	     , S5_TOP9
	     , S5_TOP10
	     , S5_TOP11
	     , S5_TOP12
	     , S5_TOP13
	     , S5_TOP14
	     , S5_TOP15
	     , S5_TOP16
	     , S5_TOP17
	     , S5_TOP18
	     , S5_TOP19
	     , S5_TOP20
	     , S5_MID1
	     , S5_MID2
	     , S5_MID3
	     , S5_MID4
	     , S5_MID5
	     , S5_MID6
	     , S5_MID7
	     , S5_MID8
	     , S5_MID9
	     , S5_MID10
	     , S5_MID11
	     , S5_MID12
	     , S5_MID13
	     , S5_MID14
	     , S5_MID15
	     , S5_MID16
	     , S5_MID17
	     , S5_MID18
	     , S5_MID19
	     , S5_MID20
	     , S5_BOT1
	     , S5_BOT2
	     , S5_BOT3
	     , S5_BOT4
	     , S5_BOT5
	     , S5_BOT6
	     , S5_BOT7
	     , S5_BOT8
	     , S5_BOT9
	     , S5_BOT10
	     , S5_BOT11
	     , S5_BOT12
	     , S5_BOT13
	     , S5_BOT14
	     , S5_BOT15
	     , S5_BOT16
	     , S5_BOT17
	     , S5_BOT18
	     , S5_BOT19
	     , S5_BOT20
	     , TO_CHAR(CREATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS CREATE_DATE
	     , CREATE_BY
	     , TO_CHAR(UPDATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS UPDATE_DATE
	     , UPDATE_BY
	  FROM TU_OPC_S5_HIST
	 WHERE (UPDATE_DATE >= TO_DATE(#{fromDate, jdbcType=VARCHAR}, 'yyyy-mm-dd')
	           AND UPDATE_DATE <![CDATA[<=]]> TO_DATE(#{toDate, jdbcType=VARCHAR}, 'yyyy-mm-dd') + 23.9997/24)
	   AND DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
	   AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR}
	 ORDER BY LAST_EVENT_SEQ 
	</select>
</mapper>