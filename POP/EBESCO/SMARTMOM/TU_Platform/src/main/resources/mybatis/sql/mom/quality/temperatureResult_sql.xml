<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 20200519/chs/온습도측정결과조회 XMOM 변환	 -->
<mapper namespace="com.thirautech.mom.quality.temperatureResult">

	<select id="get_temperatureResult_list" resultType="camelMap" parameterType="java.util.HashMap">
		SELECT (SELECT MOM_COMMON_PKG.FN_GET_FACILITY_NAME(DIVISION_CD, COMPANY_CD, RESOURCE_CD) FROM DUAL) AS FACILITY_NAME
             , TO_CHAR(CREATE_DATE, 'YYYY-MM-DD HH24:MI:SS') AS CREATE_DATE
             , TEMPERATURE
             , CP.UPPERTEMPRATURE 
             , CN.UNDERTEMPRATURE
             , HUMIDITY ||'%' AS HUMIDITY
             , CP.UPPERHUMIDITY
             , CN.UNDERHUMIDITY
             , RESULT
         FROM  MOM_POP_TEMPRATURE
             , (SELECT CODE_VALUES AS UPPERTEMPRATURE
                     , ATTRIBUTE1  ||'%' AS UPPERHUMIDITY 
                  FROM MOM_CODE
                 WHERE DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
                   AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR}
                   AND CODE_CLASS_ID = 'TEMPRATURE'
                   AND CODE_ID = 'UPPER'
                   AND USE_YN = 'Y') CP,
               (SELECT CODE_VALUES AS UNDERTEMPRATURE
                     , ATTRIBUTE1  ||'%' AS UNDERHUMIDITY 
                  FROM MOM_CODE
                 WHERE DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
                   AND COMPANY_CD = #{companyCd, jdbcType=VARCHAR}
                   AND CODE_CLASS_ID = 'TEMPRATURE'
                   AND CODE_ID = 'UNDER'
                   AND USE_YN = 'Y') CN
         WHERE DIVISION_CD = #{divisionCd, jdbcType=VARCHAR}
           AND COMPANY_CD  = #{companyCd, jdbcType=VARCHAR}
		<if test="(fromDate != null and fromDate != '') and (toDate != null and toDate !='')">
	       AND CREATE_DATE BETWEEN TO_DATE(#{fromDate, jdbcType=VARCHAR}, 'yyyy-mm-dd') 
	                             AND TO_DATE(#{toDate, jdbcType=VARCHAR}, 'yyyy-mm-dd') + 23.9997/24 
	    </if>
		 ORDER BY CREATE_DATE DESC
	</select>
	
</mapper>