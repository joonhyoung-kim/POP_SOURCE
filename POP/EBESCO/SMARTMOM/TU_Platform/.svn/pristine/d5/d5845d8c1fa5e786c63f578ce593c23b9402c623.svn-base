var search = location.search.replace("?","");
var complete = {
	currentPage	: undefined,
	initMessage	: undefined, 
	initParam	: undefined,
	
	excelParam	: undefined, 
	
	init: function() {
		var that = this;
		Language.init(function() {
			that.setting(search);
		});
		
		that.event();
		//this.design();
	},
	setting: function(search) {  			
		$('#serbi').text(search);
	},

	woReSearch : function(){
		var param = {			 
				 divisionCd: divisionCd,
				 companyCd: companyCd,
				 resourceCd: $('#serbi').val(),
				 workOrderId: $('#woNo').val()
		}
		$.ajax({
			url : tuCommon.contextPath() + "/mom/request/com.thirautech.mom.pop.popResult.get_popwo.dummy",
			type : "GET",
			data : param,			        
			async: false,
			timeout 	: 30000000,
			dataType 	: 'json',
			contentType : 'application/json; charset=UTF-8',
			success : function(data){
				if(data.length>0){		
					$('#goodQty').val(data[0].qty);
					$('#badQty').val(data[0].badQty);
				} else {
					if(data.p_err_msg != null && data.p_err_msg != undefined && data.p_err_msg != '') {
						micaCommon.messageBox({type:"danger", width:"400", height: "145", html: Language.getLang(data.p_err_msg)});
					} else {
						micaCommon.messageBox({type:"danger", width:"400", height: "145", html: Language.lang['MESSAGES10821']});
					}
					console.log(data);
				}
				
			}
		});
		
	},	
	event: function() {
		var that = this;
		var cnt = 0;		
		$(document).on('click', '#closeBtn', function() {
			
			//momWidget.messageBox({type:'warning', width:'400', height: '145', html:Language.lang['MESSAGES10685']});		
			window.close();
		});
	$(document).on('click', '#pauseBtn', function() {
			
			//momWidget.messageBox({type:'warning', width:'400', height: '145', html:Language.lang['MESSAGES10685']});		
			window.close();
		});
		// 작업시작
		$(document).on("click", "#performRegBtn", function() {
			
			var saveItem="";
			var goodQtyCount=0;
	
			
			var chkFlag = false;
			var param = {
					 p_serialnumber : "lotId",
					 p_division_cd: divisionCd,
					 p_company_cd: companyCd,
					 p_work_order_id: $('#woNo').val(),
					 p_wo_state: "R",
					 p_shift_cd: "DAY",
				     p_work_person: "1",
				     p_good_qty: $('#goodQty').val(),
					 p_bad_qty: $('#badQty').val(),
					 p_description: "pop실적",
					 p_close_flag: "N",
					 p_badcode: "BAD",
					 p_destination: "",
					 p_update_by: userId,
					 p_short_sn: "K",
					 p_long_sn: "JH"	
					
				}
			$.ajax({
				url : tuCommon.contextPath() + "/mom/request/com.thirautech.mom.pop.popResult.create_popworesult2_proc",
				type : "GET",
				data : param,			        
				async: false,
				timeout 	: 30000000,
				dataType 	: 'json',
				contentType : 'application/json; charset=UTF-8',
				success : function(data){
					if(data.length>0){		
						that.woReSearch();
						micaCommon.messageBox({type:"success", width:"400", height: "145", html:Language.lang['MESSAGES10692']});
						
					} else {
						if(data.p_err_msg != null && data.p_err_msg != undefined && data.p_err_msg != '') {
							micaCommon.messageBox({type:"danger", width:"400", height: "145", html: Language.getLang(data.p_err_msg)});
						} else {
							micaCommon.messageBox({type:"danger", width:"400", height: "145", html: Language.lang['MESSAGES10821']});
						}
						console.log(data);
					}
					
				}
			});
			
				//micaCommon.messageBox({type:"warning", width:"400", height:"145", html:Language.lang['MESSAGES11339']});
					
						//mom_ajax("C", "pop.popResult.create_popworesult2_proc", JSON.stringify(param), that.createCallback, woId);

		});

		
		$(document).on('click', '#actionBtn11', function() {
			that.currentPage = {menuId : 'MOMKA001_2'};
			that.initParam = that.currentPage;
			that.excelParam = that.currentPage;
			
			$('#pop').momModal('show');
			AUIGrid.resize(momWidget.grid[0], $(window).width() * 0.488 - 48, 320);
			/*AUIGrid.setColumnPropByDataField(momWidget.grid[0], 'resourceCd', {style:'columnStyle'});
			AUIGrid.setColumnPropByDataField(momWidget.grid[0], 'seq', {style:'columnStyle'});*/
		});
		
		
		
		/*$(document).on('click', '#excelDownBtn1', function() {
			momWidget.procResize();
		});
		
		$(document).on('click', '#excelTemplateBtn1', function() {
			momWidget.init(1, 'MOMKA001', MOMKA001, 'reInit');
		});*/
		
		

	}, /*, design: function(){
		$('head').append('<style>.columnStyle{ background: #C7E8FD;}</style>');	
	}*/
};

$(document).ready(function(event) {	
	complete.init();
});